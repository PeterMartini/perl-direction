<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:pmartini@pmubuntu.(none)" />
</head>

<body>



<ul id="index">
  <li><a href="#Title">Title</a></li>
  <li><a href="#Problem-Statement">Problem Statement</a>
    <ul>
      <li><a href="#Sub-Problems">Sub-Problems</a></li>
      <li><a href="#Backwards-Compatibility-Constraints">Backwards Compatibility Constraints</a></li>
    </ul>
  </li>
  <li><a href="#Possible-Solutions">Possible Solutions</a>
    <ul>
      <li><a href="#Add-a-header-trailer-to-each-message">Add a header/trailer to each message</a>
        <ul>
          <li><a href="#Implementation">Implementation</a></li>
          <li><a href="#Impact---Positives">Impact - Positives</a></li>
          <li><a href="#Impact---Negatives">Impact - Negatives</a></li>
          <li><a href="#Objections">Objections</a></li>
        </ul>
      </li>
      <li><a href="#Initialize-as-a-tied-scalar-backed-by-a-true-object">Initialize $@ as a tied scalar backed by a true object</a>
        <ul>
          <li><a href="#Impact---Positives1">Impact - Positives</a></li>
          <li><a href="#Impact---Negatives1">Impact - Negatives</a></li>
          <li><a href="#Objections1">Objections</a></li>
        </ul>
      </li>
      <li><a href="#Create-a-new-error-object-in-main">Create a new error object in %main::</a>
        <ul>
          <li><a href="#Impact---Positives2">Impact - Positives</a></li>
          <li><a href="#Impact---Negatives2">Impact - Negatives</a></li>
          <li><a href="#Objections2">Objections</a></li>
        </ul>
      </li>
      <li><a href="#Create-a-new-C-XS-level-object-something-like-PL_errorobj">Create a new C/XS level object, something like PL_errorobj</a>
        <ul>
          <li><a href="#Impact---Positives3">Impact - Positives</a></li>
          <li><a href="#Impact---Negatives3">Impact - Negatives</a></li>
          <li><a href="#Objections3">Objections</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#Background">Background</a>
    <ul>
      <li><a href="#Related-parts-of-Perl-5">Related parts of Perl 5</a></li>
      <li><a href="#Related-threads-on-perl5-porters-unless-in-RT">Related threads on perl5-porters (unless in RT)</a></li>
      <li><a href="#Related-tickets">Related tickets</a></li>
      <li><a href="#Related-proposals-for-Perl-5">Related proposals for Perl 5</a></li>
      <li><a href="#Related-notes-from-Perl-6">Related notes from Perl 6</a></li>
    </ul>
  </li>
</ul>

<h1 id="Title">Title</h1>

<p>Add richer information to core warnings and errors</p>

<h1 id="Problem-Statement">Problem Statement</h1>

<p>There are a large number of warnings and errors in Perl 5, with a number of new ones being added, old ones removed, or existing ones modified between releases. Currently, the only way to check against one error or another is to do string matching, which is brittle and inefficient.</p>

<h2 id="Sub-Problems">Sub-Problems</h2>

<dl>

<dt id="Uniquely-identify-an-error-warning">Uniquely identify an error/warning</dt>
<dd>

<p>The error string may change, but as long as there is some component that is stable and uniquely identifies the message, that part can be used for future-proofing.</p>

</dd>
<dt id="Provide-a-language-neutral-reference">Provide a language-neutral reference</dt>
<dd>

<p>Error strings in Perl 5 are provided in English only; providing an alternate key could make searches or translation easier.</p>

</dd>
</dl>

<h2 id="Backwards-Compatibility-Constraints">Backwards Compatibility Constraints</h2>

<p>Any solution chosen must fit the following set of constraints:</p>

<dl>

<dt id="No-objectification">No objectification</dt>
<dd>

<p>Any code which does not explicitly agree to seeing an object should always see <code>$@</code>, the argument in a <code>$sig{__WARN__}</code> handler, etc, as a simple string when it&#39;s being generated by the Perl 5 interpreter.</p>

</dd>
</dl>

<h1 id="Possible-Solutions">Possible Solutions</h1>

<p>A number of mechanisms have been proposed and discussed, with summaries, implementation options, and how those choices may constrain or complement other initiatives listed below. These are not necessarily mutually exclusive; a solution could involve combining multiple options.</p>

<h2 id="Add-a-header-trailer-to-each-message">Add a header/trailer to each message</h2>

<p>The simplest variant of this scheme is to add a unique number per message to the start of the text of each warning or error, though the positioning of the number and whether additional metadata (such as category) should be added are points of stylistic debate.</p>

<h3 id="Implementation">Implementation</h3>

<h3 id="Impact---Positives">Impact - Positives</h3>

<h3 id="Impact---Negatives">Impact - Negatives</h3>

<h3 id="Objections">Objections</h3>

<h2 id="Initialize-as-a-tied-scalar-backed-by-a-true-object">Initialize <code>$@</code> as a tied scalar backed by a true object</h2>

<h3 id="Impact---Positives1">Impact - Positives</h3>

<h3 id="Impact---Negatives1">Impact - Negatives</h3>

<h3 id="Objections1">Objections</h3>

<h2 id="Create-a-new-error-object-in-main">Create a new error object in <code>%main::</code></h2>

<h3 id="Impact---Positives2">Impact - Positives</h3>

<h3 id="Impact---Negatives2">Impact - Negatives</h3>

<h3 id="Objections2">Objections</h3>

<h2 id="Create-a-new-C-XS-level-object-something-like-PL_errorobj">Create a new C/XS level object, something like <code>PL_errorobj</code></h2>

<h3 id="Impact---Positives3">Impact - Positives</h3>

<h3 id="Impact---Negatives3">Impact - Negatives</h3>

<h3 id="Objections3">Objections</h3>

<h1 id="Background">Background</h1>

<h2 id="Related-parts-of-Perl-5">Related parts of Perl 5</h2>

<dl>

<dt id="the-error-object"><code>$@</code> - the error object</dt>
<dd>

</dd>
<dt id="SIG-__WARN__---a-custom-warning-handler"><code>$SIG{__WARN__}</code> - a custom warning handler</dt>
<dd>

</dd>
<dt id="SIG-__DIE__---a-custom-error-handler"><code>$SIG{__DIE__}</code> - a custom error handler</dt>
<dd>

</dd>
<dt id="perldoc-perldiag">perldoc perldiag</dt>
<dd>

<p>perldiag is the master list of all warning and error messages, and one of the tests in the test suite ensures that all messages are present in this file. Any changes to the wording will have to be reflected here, but there&#39;s room for significant changes to effect indexing.</p>

</dd>
<dt id="warnings">warnings</dt>
<dd>

<p>Warnings already have a tree structure of classes for use in <code>use warnings ...</code> and <code>no warnings ...</code>, so having that metadata be present in the warnings themselves makes sense.</p>

</dd>
</dl>

<h2 id="Related-threads-on-perl5-porters-unless-in-RT">Related threads on perl5-porters (unless in RT)</h2>

<h2 id="Related-tickets">Related tickets</h2>

<dl>

<dt id="perl-122794"><a href="https://rt.perl.org/Public/Bug/Display.html?id=122794">[perl #122794]</a></dt>
<dd>

<p>Discussion of error and warning IDs.</p>

</dd>
<dt id="perl-122833"><a href="https://rt.perl.org/Public/Bug/Display.html?id=122833">[perl #122833]</a></dt>
<dd>

<p>Proposal for a CATCH block.</p>

</dd>
</dl>

<h2 id="Related-proposals-for-Perl-5">Related proposals for Perl 5</h2>

<h2 id="Related-notes-from-Perl-6">Related notes from Perl 6</h2>


</body>

</html>


